<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Per-Tab Audio Control - FAQ</title>
  <link rel="stylesheet" href="options-base.css">
  <link rel="stylesheet" href="options-sections.css">
  <link rel="stylesheet" href="options-visualizer.css">
  <link rel="stylesheet" href="options-info.css">
  <link rel="stylesheet" href="options-forms.css">
  <link rel="stylesheet" href="options-rules.css">
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="logo" aria-hidden="true" title="Per-Tab Audio Control">
        <!-- Dark mode logo - A top-left, B top-right, C bottom-left, speaker bottom-right -->
        <svg class="logo-dark" width="56" height="56" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <rect x="10" y="10" width="80" height="80" rx="8" stroke="#5a7a9a" stroke-width="5" fill="#0f172a"/>
          <line x1="50" y1="10" x2="50" y2="90" stroke="#5a7a9a" stroke-width="3"/>
          <line x1="10" y1="50" x2="90" y2="50" stroke="#5a7a9a" stroke-width="3"/>
          <rect x="53" y="53" width="34" height="34" rx="3" fill="#d4c78a"/>
          <text x="30" y="38" font-family="Comfortaa, sans-serif" font-size="20" font-weight="600" fill="#c9a0a0" text-anchor="middle">A</text>
          <text x="70" y="38" font-family="Comfortaa, sans-serif" font-size="20" font-weight="600" fill="#a0c9a8" text-anchor="middle">B</text>
          <text x="30" y="78" font-family="Comfortaa, sans-serif" font-size="20" font-weight="600" fill="#a0b8c9" text-anchor="middle">C</text>
          <path d="M61 66 L61 74 L65 74 L71 78 L71 62 L65 66 Z" fill="#0f172a"/>
          <path d="M74 66 Q78 70 74 74" stroke="#0f172a" stroke-width="2.5" stroke-linecap="round" fill="none"/>
          <path d="M77 63 Q83 70 77 77" stroke="#0f172a" stroke-width="2.5" stroke-linecap="round" fill="none"/>
        </svg>
        <!-- Light mode logo - A top-left, B top-right, C bottom-left, speaker bottom-right -->
        <svg class="logo-light" width="56" height="56" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <rect x="10" y="10" width="80" height="80" rx="8" stroke="#8a7a6a" stroke-width="5" fill="#faf5ef"/>
          <line x1="50" y1="10" x2="50" y2="90" stroke="#8a7a6a" stroke-width="3"/>
          <line x1="10" y1="50" x2="90" y2="50" stroke="#8a7a6a" stroke-width="3"/>
          <rect x="53" y="53" width="34" height="34" rx="3" fill="#c4a870"/>
          <text x="30" y="38" font-family="Comfortaa, sans-serif" font-size="20" font-weight="600" fill="#a07070" text-anchor="middle">A</text>
          <text x="70" y="38" font-family="Comfortaa, sans-serif" font-size="20" font-weight="600" fill="#70a078" text-anchor="middle">B</text>
          <text x="30" y="78" font-family="Comfortaa, sans-serif" font-size="20" font-weight="600" fill="#7088a0" text-anchor="middle">C</text>
          <path d="M61 66 L61 74 L65 74 L71 78 L71 62 L65 66 Z" fill="#faf5ef"/>
          <path d="M74 66 Q78 70 74 74" stroke="#faf5ef" stroke-width="2.5" stroke-linecap="round" fill="none"/>
          <path d="M77 63 Q83 70 77 77" stroke="#faf5ef" stroke-width="2.5" stroke-linecap="round" fill="none"/>
        </svg>
      </div>
      <h1>FAQ</h1>
      <p class="header-tagline">The audio controls browsers forgot to include</p>
      <a href="options.html" class="header-btn" title="Back to Settings" aria-label="Back to Settings">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M19 12H5M12 19l-7-7 7-7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </a>
      <button class="header-btn" id="expandAllToggle" title="Expand all sections" aria-label="Expand all sections" aria-expanded="false">
        <svg class="icon-expand" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <polyline points="6 9 12 15 18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <polyline points="6 4 12 10 18 4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <svg class="icon-collapse" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <polyline points="18 15 12 9 6 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          <polyline points="18 20 12 14 6 20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
      </button>
      <button class="header-btn" id="themeToggle" title="Toggle morning/bedtime" aria-label="Toggle morning/bedtime">
        <svg class="icon-moon" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        <svg class="icon-sun" width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="12" cy="12" r="5" stroke="currentColor" stroke-width="2"/>
          <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
    </header>

    <!-- About Branding -->
    <div class="about-header">
      <div class="about-logo">
        <!-- Dark mode logo - A top-left, B top-right, C bottom-left, moon bottom-right -->
        <svg class="logo-dark" width="48" height="48" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg" aria-label="After Bedtime Creations logo">
          <rect x="10" y="10" width="80" height="80" rx="8" stroke="#5a7a9a" stroke-width="5" fill="#0f172a"/>
          <line x1="50" y1="10" x2="50" y2="90" stroke="#5a7a9a" stroke-width="3"/>
          <line x1="10" y1="50" x2="90" y2="50" stroke="#5a7a9a" stroke-width="3"/>
          <rect x="53" y="53" width="34" height="34" rx="3" fill="#d4c78a"/>
          <text x="30" y="38" font-family="Comfortaa, sans-serif" font-size="20" font-weight="600" fill="#c9a0a0" text-anchor="middle">A</text>
          <text x="70" y="38" font-family="Comfortaa, sans-serif" font-size="20" font-weight="600" fill="#a0c9a8" text-anchor="middle">B</text>
          <text x="30" y="78" font-family="Comfortaa, sans-serif" font-size="20" font-weight="600" fill="#a0b8c9" text-anchor="middle">C</text>
          <path d="M80 70 A11 11 0 1 1 70 58 A8 8 0 0 0 80 70" fill="#0f172a"/>
        </svg>
        <!-- Light mode logo - A top-left, B top-right, C bottom-left, moon bottom-right -->
        <svg class="logo-light" width="48" height="48" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg" aria-label="After Bedtime Creations logo">
          <rect x="10" y="10" width="80" height="80" rx="8" stroke="#8a7a6a" stroke-width="5" fill="#faf5ef"/>
          <line x1="50" y1="10" x2="50" y2="90" stroke="#8a7a9a" stroke-width="3"/>
          <line x1="10" y1="50" x2="90" y2="50" stroke="#8a7a6a" stroke-width="3"/>
          <rect x="53" y="53" width="34" height="34" rx="3" fill="#c4a870"/>
          <text x="30" y="38" font-family="Comfortaa, sans-serif" font-size="20" font-weight="600" fill="#a07070" text-anchor="middle">A</text>
          <text x="70" y="38" font-family="Comfortaa, sans-serif" font-size="20" font-weight="600" fill="#70a078" text-anchor="middle">B</text>
          <text x="30" y="78" font-family="Comfortaa, sans-serif" font-size="20" font-weight="600" fill="#7088a0" text-anchor="middle">C</text>
          <path d="M80 70 A11 11 0 1 1 70 58 A8 8 0 0 0 80 70" fill="#faf5ef"/>
        </svg>
      </div>
      <div class="about-content">
        <div class="about-brand"><span class="brand-a">A</span>fter <span class="brand-b">B</span>edtime <span class="brand-c">C</span>reations</div>
        <div class="about-tagline">Privacy-focused software, built late.</div>
      </div>
      <div class="about-links">
        <a href="https://afterbedtimecreations.com" target="_blank" rel="noopener noreferrer" class="about-link icon-only" title="Website" aria-label="Visit website">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="2" y1="12" x2="22" y2="12"></line>
            <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
          </svg>
        </a>
        <a href="https://github.com/AfterBTCreate" target="_blank" rel="noopener noreferrer" class="about-link icon-only" title="GitHub" aria-label="Visit GitHub">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
          </svg>
        </a>
        <a href="https://x.com/AfterBTCreate" target="_blank" rel="noopener noreferrer" class="about-link icon-only" title="X (Twitter)" aria-label="Visit X (Twitter)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
          </svg>
        </a>
      </div>
    </div>

    <!-- Q1: Volume limited -->
    <div class="faq-subsection">
      <h3 class="faq-subsection-header" role="button" aria-expanded="false" tabindex="0">
        <span>Why can't I boost volume above 100%?</span>
        <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </h3>
      <div class="faq-subsection-content">
        <p class="section-desc">If volume is capped at 100%, audio processing is <strong>disabled</strong>.</p>
        <div class="info-box">
          <h4>What's happening</h4>
          <p>When audio processing is disabled, the extension uses the browser's native volume control, which limits volume to 0-100%. This happens when:</p>
          <ul class="feature-list">
            <li>You previously disabled audio processing on this domain</li>
            <li>Your default audio mode is set to Disabled</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>How to fix</h4>
          <ol class="chain-list">
            <li>Select Tab Capture (Chrome) or Web Audio mode from the popup header</li>
            <li>The page will auto-refresh and 0-500% volume will be available</li>
            <li>If this happens on every site, change your default mode in Settings → Audio Modes</li>
          </ol>
        </div>
      </div>
    </div>

    <!-- Q2: No sound -->
    <div class="faq-subsection">
      <h3 class="faq-subsection-header" role="button" aria-expanded="false" tabindex="0">
        <span>Why is there no sound on this site?</span>
        <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </h3>
      <div class="faq-subsection-content">
        <p class="section-desc">Some websites don't work well with certain audio modes. Try switching to a different mode—you'll keep all enhancements.</p>
        <div class="info-box">
          <h4>Why this happens</h4>
          <p>The extension processes audio to enable boost and effects. Some sites have audio that's incompatible with this processing, causing:</p>
          <ul class="feature-list">
            <li>No sound at all</li>
            <li>Audio pops, clicks, or distortion</li>
            <li>Audio/video sync issues</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>How to fix</h4>
          <ol class="chain-list">
            <li>Try switching to a different audio mode (Tab Capture, Web Audio) from the popup header</li>
            <li>The page will auto-refresh and audio should work</li>
            <li>If neither mode works, select Disabled (limits volume to 0-100%)</li>
          </ol>
          <p style="margin-top: 8px;">Different sites work better with different modes. Your choice is saved per-site.</p>
        </div>
      </div>
    </div>

    <!-- Q3: Microphone permission -->
    <div class="faq-subsection">
      <h3 class="faq-subsection-header" role="button" aria-expanded="false" tabindex="0">
        <span>Why does the extension need microphone permission?</span>
        <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </h3>
      <div class="faq-subsection-content">
        <p class="section-desc">The microphone permission is required to list audio output devices. <strong>The extension never records audio.</strong></p>
        <div class="info-box">
          <h4>Why this is necessary</h4>
          <p>Browsers require microphone permission to access the list of audio devices (speakers, headphones, etc.). This is a browser security requirement, not a choice by the extension.</p>
          <ul class="feature-list">
            <li>Without permission: Only "Default" device available</li>
            <li>With permission: All your audio devices appear in the dropdown</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>Privacy note</h4>
          <p>The extension only calls <code>navigator.mediaDevices.enumerateDevices()</code> to get device names. No audio streams are ever created, recorded, or transmitted.</p>
        </div>
      </div>
    </div>

    <!-- Q4: Multiple prompts -->
    <div class="faq-subsection">
      <h3 class="faq-subsection-header" role="button" aria-expanded="false" tabindex="0">
        <span>Why am I seeing multiple permission prompts?</span>
        <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </h3>
      <div class="faq-subsection-content">
        <p class="section-desc">Some websites use iframes that each request permission separately.</p>
        <div class="info-box">
          <h4>Why this happens</h4>
          <ul class="feature-list">
            <li>The site loads games/widgets in separate embedded frames (iframes)</li>
            <li>Each iframe is treated as a separate context by the browser</li>
            <li>Each context needs its own permission grant</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>What to do</h4>
          <p>You can safely accept these prompts. The extension only uses the permission to list output devices for the device switcher dropdown.</p>
        </div>
      </div>
    </div>

    <!-- Q5: Visualizer not working -->
    <div class="faq-subsection">
      <h3 class="faq-subsection-header" role="button" aria-expanded="false" tabindex="0">
        <span>Why isn't the visualizer working?</span>
        <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </h3>
      <div class="faq-subsection-content">
        <p class="section-desc">With Tab Capture (Chrome default), the visualizer works on virtually all sites. Issues are rare but can occur with Web Audio mode or Disabled mode.</p>
        <div class="info-box">
          <h4>What you'll see</h4>
          <ul class="feature-list">
            <li>After ~2-3 seconds of no audio data, the visualizer auto-disables</li>
            <li>A "Visualizer ⊘" indicator appears in the Now Playing area</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>How to fix</h4>
          <ul class="feature-list">
            <li><strong>Chrome:</strong> Ensure Tab Capture mode is selected (default). It captures audio at browser level and works on all sites.</li>
            <li><strong>Firefox:</strong> Web Audio mode may not work on sites with cross-origin restrictions or certain security policies. Try a different site to confirm the extension is working.</li>
            <li>If you've switched to Web Audio or Disabled mode, select Tab Capture (Chrome) from the popup header</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>Visualizer strobing or flickering?</h4>
          <p>If the visualizer appears to strobe or flicker erratically:</p>
          <ul class="feature-list">
            <li><strong>Close and reopen the popup</strong> — this usually resolves the issue immediately</li>
            <li>This can occasionally happen when switching audio modes</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>Good news</h4>
          <p>Visualizer issues are purely cosmetic. <strong>All audio controls still work normally</strong> — volume, effects, balance, and device switching are unaffected.</p>
        </div>
      </div>
    </div>

    <!-- Q6: Volume different on device switch -->
    <div class="faq-subsection">
      <h3 class="faq-subsection-header" role="button" aria-expanded="false" tabindex="0">
        <span>Why does volume change when I switch devices?</span>
        <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </h3>
      <div class="faq-subsection-content">
        <p class="section-desc">Each audio device has its own volume level in your operating system.</p>
        <div class="info-box">
          <h4>Why this happens</h4>
          <ul class="feature-list">
            <li>Your default device's volume is what you've adjusted in system settings</li>
            <li>Other devices often sit at 100% OS volume (never adjusted)</li>
            <li>External devices (Bluetooth, USB) may have their own hardware volume</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>How to fix</h4>
          <p>Adjust the device's volume in your OS sound settings, or use the extension's volume slider to compensate.</p>
        </div>
      </div>
    </div>

    <!-- Q7: Volume difference between modes -->
    <div class="faq-subsection">
      <h3 class="faq-subsection-header" role="button" aria-expanded="false" tabindex="0">
        <span>Why does volume sound different between audio modes?</span>
        <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </h3>
      <div class="faq-subsection-content">
        <p class="section-desc">This is expected behavior due to how audio is processed differently in each mode.</p>
        <div class="info-box">
          <h4>Tab Capture mode</h4>
          <p>Audio flows through a processing pipeline:</p>
          <ul class="feature-list">
            <li>Tab audio is captured at the browser level</li>
            <li>Routed through Web Audio API (MediaStreamSource → GainNode → Limiter → Output)</li>
            <li>Even at 100% volume (gain = 1.0), this routing introduces slight signal attenuation</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>Web Audio mode</h4>
          <p>Audio is intercepted at the page level:</p>
          <ul class="feature-list">
            <li>Hooks into the page's audio elements and AudioContext</li>
            <li>Similar routing to Tab Capture (GainNode → Limiter → Output)</li>
            <li>Volume may vary depending on how the site creates audio</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>Disabled mode</h4>
          <p>Audio goes directly to speakers:</p>
          <ul class="feature-list">
            <li>Uses the browser's native <code>element.volume</code> property</li>
            <li>No AudioContext routing or processing</li>
            <li>Direct path = louder perceived volume at the same slider position</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>Tip</h4>
          <p>When switching modes, you may need to adjust the volume slider slightly to match your preferred loudness level.</p>
        </div>
      </div>
    </div>

    <!-- Q8: Why click extension for each tab (Chrome only) -->
    <div class="faq-subsection">
      <h3 class="faq-subsection-header" role="button" aria-expanded="false" tabindex="0">
        <span>Why do I need to click the extension for each tab? (Chrome)</span>
        <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </h3>
      <div class="faq-subsection-content">
        <p class="section-desc">Chrome requires a "user gesture" before Tab Capture can access a tab's audio. This is a browser security feature that applies to Chrome only.</p>
        <div class="info-box">
          <h4>Why this requirement exists</h4>
          <p>Chrome prevents extensions from silently capturing audio without your knowledge. By requiring a user gesture (clicking the extension icon or using a keyboard shortcut), Chrome ensures you've consciously granted permission.</p>
        </div>
        <div class="info-box">
          <h4>How to know when Tab Capture needs enabling</h4>
          <p>Look for the <strong>blue !</strong> badge on the extension icon — this indicates Tab Capture isn't active on the current tab yet. Click the extension or use a keyboard shortcut to enable it. (See the badge question below for all badge types.)</p>
        </div>
        <div class="info-box">
          <h4>How it works</h4>
          <ul class="feature-list">
            <li>Opening the popup while a tab is active grants Tab Capture permission for that tab</li>
            <li>Once activated, Tab Capture stays active on that tab until you close it</li>
            <li>You can switch to other tabs freely — Tab Capture keeps running in the background</li>
            <li>Your volume, bass, treble, and other settings persist on that tab</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>Tip</h4>
          <p>You only need to open the popup once per tab. After that, Tab Capture remains active even when the popup is closed, and the <strong>blue !</strong> badge will disappear.</p>
        </div>
      </div>
    </div>

    <!-- Q9: Badge colors -->
    <div class="faq-subsection">
      <h3 class="faq-subsection-header" role="button" aria-expanded="false" tabindex="0">
        <span>What do the colored ! badges on the extension icon mean?</span>
        <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </h3>
      <div class="faq-subsection-content">
        <p class="section-desc">The extension icon shows different colored <strong>!</strong> badges to indicate the current state. These are checked in priority order.</p>
        <div class="info-box">
          <h4>Blue ! — Tab Capture pending (Chrome only)</h4>
          <p>Tab Capture needs a user gesture to activate on this tab. Click the extension icon or use a keyboard shortcut to enable it. Once activated, the badge changes to the normal volume display.</p>
        </div>
        <div class="info-box">
          <h4>Red ! — Site rule pending (Chrome only)</h4>
          <p>A saved site rule is waiting to be applied. This appears instead of the blue badge when a site rule exists for the current domain, since the rule can't apply until Tab Capture is activated. Click the extension icon to apply both.</p>
        </div>
        <div class="info-box">
          <h4>Yellow ! — Restricted page</h4>
          <p>The extension can't run on this page type. This appears on browser-internal pages like <code>chrome://</code>, <code>about:</code>, extension pages, and browser stores. Audio control isn't available on these pages.</p>
        </div>
        <div class="info-box">
          <h4>Volume percentage badge (normal state)</h4>
          <p>When none of the above conditions apply, the icon shows the current tab's volume percentage. The badge color depends on your badge style setting in Settings:</p>
          <ul class="feature-list">
            <li><strong>Light on Dark</strong> — White text on black background (default)</li>
            <li><strong>Dark on Light</strong> — Black text on white background</li>
            <li><strong>Volume Color</strong> — Color changes with volume level (blue → green → yellow → orange → purple)</li>
          </ul>
          <p style="margin-top: 8px;">At 0% (muted), the badge always turns red regardless of style.</p>
        </div>
      </div>
    </div>

    <!-- Q10: What syncs -->
    <div class="faq-subsection">
      <h3 class="faq-subsection-header" role="button" aria-expanded="false" tabindex="0">
        <span>What settings sync across my devices?</span>
        <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </h3>
      <div class="faq-subsection-content">
        <p class="section-desc">Most settings sync automatically when signed into your browser account.</p>
        <div class="info-box">
          <h4>Synced settings</h4>
          <ul class="feature-list">
            <li>All preset values (volume, bass, treble, voice, speed, balance, volume steps)</li>
            <li>Site rules and disabled domains list</li>
            <li>Audio mode overrides (Tab Capture, Web Audio, and Disabled sites)</li>
            <li>Default audio mode</li>
            <li>Theme, visualizer style/color, EQ mode, Basic/Advanced mode, badge style</li>
            <li>Header layout and popup sections customization</li>
            <li>Visibility preferences (visualizer, seekbar, shortcuts footer)</li>
            <li>Seekbar time display (total/remaining), tab info location</li>
            <li>UI state (expanded/collapsed sections)</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>Local only</h4>
          <ul class="feature-list">
            <li>Default audio device (different hardware per device)</li>
            <li>Current tab volumes (session-specific)</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>Note</h4>
          <p>Sync only works within the same browser. Chrome syncs to Chrome, Firefox to Firefox, etc. Cross-browser sync is not possible.</p>
        </div>
      </div>
    </div>

    <!-- Q10: Reset everything -->
    <div class="faq-subsection">
      <h3 class="faq-subsection-header" role="button" aria-expanded="false" tabindex="0">
        <span>How do I reset everything to defaults?</span>
        <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </h3>
      <div class="faq-subsection-content">
        <p class="section-desc">There are several ways to reset settings, depending on what you need.</p>
        <div class="info-box">
          <h4>Popup reset controls</h4>
          <ul class="feature-list">
            <li><strong>Reset current tab</strong> — Click the ↺ button in the header area. Resets volume, balance, channel mode, all effects, and output device to defaults.</li>
            <li><strong>Reset balance</strong> — Click the ⟲ button next to the balance slider</li>
            <li><strong>Reset individual effects</strong> — Click the ⟲ button next to each effect slider (speed, bass, treble, voice, range)</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>Settings page reset controls</h4>
          <ul class="feature-list">
            <li><strong>Reset individual sections</strong> — Use "Reset to Defaults" buttons in each Settings section</li>
            <li><strong>Reset everything</strong> — Use "Reset All Settings" in the Data Management section</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>What "Reset All Settings" clears</h4>
          <ul class="feature-list">
            <li>All preset values back to defaults</li>
            <li>All site rules and disabled domains deleted</li>
            <li>All audio mode overrides cleared (Tab Capture, Web Audio, Disabled sites)</li>
            <li>Default audio mode reset</li>
            <li>Theme, visualizer style/color, EQ mode, Basic/Advanced mode, badge style reset to defaults</li>
            <li>Header layout and popup sections reset to default</li>
            <li>Visibility preferences reset (visualizer, seekbar, shortcuts footer)</li>
            <li>Seekbar time display, tab info location reset to defaults</li>
            <li>Default audio device setting cleared</li>
          </ul>
          <p style="margin-top: 8px;"><strong>Note:</strong> Keyboard shortcuts and microphone permissions are managed by your browser. See Settings → Browser Settings to manage these.</p>
        </div>
      </div>
    </div>

    <!-- Q12: Keyboard shortcuts -->
    <div class="faq-subsection">
      <h3 class="faq-subsection-header" role="button" aria-expanded="false" tabindex="0">
        <span>Does the extension have keyboard shortcuts?</span>
        <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </h3>
      <div class="faq-subsection-content">
        <p class="section-desc">Yes — three global keyboard shortcuts work from any tab without opening the popup.</p>
        <div class="info-box">
          <h4>Default shortcuts</h4>
          <ul class="feature-list">
            <li><strong>Alt+Shift+Up</strong> — Increase volume</li>
            <li><strong>Alt+Shift+Down</strong> — Decrease volume</li>
            <li><strong>Alt+Shift+M</strong> — Toggle mute</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>Customizing shortcuts</h4>
          <ul class="feature-list">
            <li><strong>Chrome:</strong> Go to <code>chrome://extensions/shortcuts</code></li>
            <li><strong>Firefox:</strong> Go to <code>about:addons</code> → gear icon → Manage Extension Shortcuts</li>
          </ul>
          <p style="margin-top: 8px;">You can change these to any key combination that doesn't conflict with browser or system shortcuts.</p>
        </div>
      </div>
    </div>

    <!-- Q13: DRM / protected sites -->
    <div class="faq-subsection">
      <h3 class="faq-subsection-header" role="button" aria-expanded="false" tabindex="0">
        <span>Does the extension work on Spotify, Netflix, and other DRM sites?</span>
        <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </h3>
      <div class="faq-subsection-content">
        <p class="section-desc">Yes, with some limitations depending on the audio mode.</p>
        <div class="info-box">
          <h4>Tab Capture mode (Chrome, recommended)</h4>
          <p>Works best on DRM sites. Tab Capture captures audio at the browser level, so DRM restrictions don't affect it. Volume boost, effects, and visualizer all work.</p>
        </div>
        <div class="info-box">
          <h4>Web Audio mode</h4>
          <p>May have limited functionality on DRM-protected content. Audio elements using Encrypted Media Extensions (EME) can restrict access to the audio stream, preventing boost and effects from being applied.</p>
        </div>
        <div class="info-box">
          <h4>Playback controls</h4>
          <p>Play/pause and seeking work on Spotify and similar sites by interacting with the site's own UI controls, since the underlying audio elements may not be directly accessible.</p>
        </div>
      </div>
    </div>

    <!-- Q14: Privacy -->
    <div class="faq-subsection">
      <h3 class="faq-subsection-header" role="button" aria-expanded="false" tabindex="0">
        <span>Does the extension collect any data?</span>
        <svg class="collapse-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <polyline points="6 9 12 15 18 9"></polyline>
        </svg>
      </h3>
      <div class="faq-subsection-content">
        <p class="section-desc">No. The extension has no analytics, no tracking, and makes no external network requests.</p>
        <div class="info-box">
          <h4>What stays local</h4>
          <ul class="feature-list">
            <li>All settings are stored in your browser's local and sync storage</li>
            <li>No data is ever sent to external servers</li>
            <li>No third-party libraries, scripts, or dependencies</li>
            <li>Microphone permission is only used to list audio output devices — no audio is ever recorded or transmitted</li>
          </ul>
        </div>
        <div class="info-box">
          <h4>Sync storage</h4>
          <p>If you're signed into your browser, settings sync through your browser account (Chrome Sync or Firefox Sync). This is handled entirely by the browser — the extension doesn't manage or access your account.</p>
        </div>
      </div>
    </div>

  </div>

  <!-- Shared utilities - must load first -->
  <script src="../shared/browser-api.js"></script>
  <script src="faq.js"></script>
</body>
</html>
